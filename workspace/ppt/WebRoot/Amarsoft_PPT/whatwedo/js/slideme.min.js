/*!
 * SlideMe v1.0.0
 * Docs & License: Matteo Martinelli
 * (c) 2013 Matteo Martinelli
 */
(function(e){var f={drag:false,autodrag:false,refreshAgo:true,previous:[0,0],limitsStart:40,topStart:0,refreshTime:60000,refreshAgoTime:300000,speed:[1000,2000],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ago:["few second","m","h","d"],noNotice:"No new notification"};e.fn.SlideMe=function(h){e.extend(f,h);this.each(function(l,j){var k=e(j);var m=new c(k);m.render()});return this};var c=function(m){var x=this;var u=e(window);x.render=i;var n;var q;var j;var s;mouseMoveEvent=function(t){f.previous[0]=f.previous[1];f.previous[1]=t.clientY;if(f.drag){if(t.clientY>20){m.css({top:t.clientY-m.innerHeight()})}if(m.position().top>0){m.css({top:0})}}};mouseUpEvent=function(){if(f.drag){f.drag=false;f.autodrag=true;if(Math.abs(f.topStart-m.position().top)<f.limitsStart){m.animate({top:f.topStart},f.speed[0],function(){m.children(".label").removeClass("mousedown");f.autodrag=false})}else{if(f.previous[0]<f.previous[1]){m.animate({top:u.height()-m.height()},f.speed[1],function(){m.children(".label").removeClass("mousedown");f.autodrag=false})}else{if(f.previous[0]>f.previous[1]){m.animate({top:-u.height()+20},f.speed[1],function(){m.children(".label").removeClass("mousedown");f.autodrag=false})}else{m.animate({top:f.topStart},f.speed[0],function(){m.children(".label").removeClass("mousedown");f.autodrag=false})}}}}};mouseDownEvent=function(){f.drag=true;f.topStart=m.position().top;q.addClass("mousedown")};resizeEvent=function(){m.children(".container").css({height:u.innerHeight()-20});if(m.position().top==0){m.css({height:u.innerHeight(),width:u.innerWidth()})}else{m.css({height:u.innerHeight(),width:u.innerWidth(),top:-(u.innerHeight()-20)})}};deleteEvent=function(){var z=e(this).parent("div").parent("li");var t=z.parent("ul");var w=[];e.each(z.children("ul").children("li"),function(B,A){var C=A.id.replace("notification_","");w.push(C);f.notifications.splice(p(C),1)});if(z.hasClass("first")){z.next().addClass("first")}z.animate({height:0,opacity:0},700,function(){e(this).remove();if(t.children("li").size()==0){t.html('<span class="nonotice">'+f.noNotice+"</span>")}});if(f.ondelete){f.ondelete(w)}};function i(){o();l();q=m.children(".label");n=m.children(".container").children(".content");j=n.children(".time");s=n.children(".notifications").children("ul");r();k();y()}function k(){e(document).mousemove(mouseMoveEvent).mouseup(mouseUpEvent);u.resize(resizeEvent);q.mousedown(mouseDownEvent).hover(function(){if(!f.autodrag&&!f.drag){q.addClass("mousedown")}},function(){if(!f.autodrag&&!f.drag){q.removeClass("mousedown")}})}function h(){var t=new Date();j.children(".hour").html(b(t.getHours())+":"+b(t.getMinutes()));j.children(".day").html(a(t.getDay()).toUpperCase()+"<br />"+g(t.getMonth()).toUpperCase()+" "+b(t.getDate())+", "+t.getFullYear())}function v(){e.each(f.notifications,function(A,z){var w=d(new Date,z.ago);var t="";if(w<60*1000){t=f.ago[0]+" ago"}else{if(w<60*60*1000){t=Math.ceil(w/(60*1000))+f.ago[1]+" ago"}else{if(w<24*60*60*1000){t=Math.ceil(w/(60*60*1000))+f.ago[2]+" ago"}else{t=Math.ceil(w/(24*3600000))+f.ago[3]+" ago"}}}e("#notification_"+z.id).children("div").children(".ago").text(t)})}function y(){h();setInterval(h,f.refreshTime);if(f.refreshAgo){setInterval(v,f.refreshAgoTime)}}function o(){m.append('<div class="label"><div class="one"></div></div>')}function l(){m.append('<div class="container"><div class="content"><div class="time"><div class="hour"></div><div class="day"></div></div><div class="notifications"><ul></ul></div></div></div>');m.css({width:u.innerWidth(),height:u.innerHeight(),top:-(u.innerHeight()-20)});m.children(".container").css({height:m.height()-20})}function r(){f.notifications.sort(function(w,t){var A=w.ago;var z=t.ago;return z-A});e.each(f.categories,function(z,w){var t=e("<li>").attr("id","category_"+z);var A=e("<div>").addClass("head").append(e("<img>").addClass("icon").attr("src",w.icon)).append(e("<span>").text(w.title)).append(e("<div>").addClass("delete").bind("click",deleteEvent));t.append(A);var B=e("<ul>");e.each(f.notifications,function(H,G){if(G.category==z){var D=e("<li>").attr("id","notification_"+G.id);var E=d(new Date,G.ago);var C="";if(E<60*1000){C=f.ago[0]+" ago"}else{if(E<60*60*1000){C=Math.ceil(E/(60*1000))+f.ago[1]+" ago"}else{if(E<24*60*60*1000){C=Math.ceil(E/(60*60*1000))+f.ago[2]+" ago"}else{C=Math.ceil(E/(24*3600000))+f.ago[3]+" ago"}}}var F=e("<div>").append(e("<span>").addClass("subtitle").text(G.title)).append(e("<span>").addClass("description").html(G.text)).append(e("<span>").addClass("ago").text(C));B.append(D.append(F))}});t.append(B);s.append(t)})}function p(w){var t=-1;e.each(f.notifications,function(A,z){if(z.id==w&&t==-1){t=A}});return t}};function d(i,h){return(i.valueOf()-h.valueOf())}function b(h){return(parseInt(h)<10)?"0"+h:h}function g(h){return f.monthNames[h]}function a(h){return f.dayNames[h]}})(jQuery);