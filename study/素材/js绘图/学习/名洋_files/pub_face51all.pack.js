if(typeof(String.prototype.trim)!="function"){String.prototype.trim=function(){return this.replace(/(^[\s]*)|([\s]*$)/g,"");};}function faceTo51All(a){if(typeof(a)!="string"||a==""){throw (new Error(-1,"创建类实例的时候请把类实例的引用变量名传递进来！"));}var b=this;this.name=a;this.isInit=false;this.titles={face8:["","微笑","憨笑","无语","尴尬","可爱","","鼓掌","惊讶","晕","茫然","调皮","大笑","恐惧","闭嘴","嘘","撇嘴","吐","狂汗","色色","意淫","汗","怒","斜眼","哭","挖鼻孔","哼","好困","烦躁","鄙视","钱","骂","委屈","糗大了","伤心","疑问","酷","羞涩","抛媚眼","偷笑","害羞","拜拜","坏笑","衰","哇","鬼脸","猪头","便便","磨刀","月亮","太阳","手机","彩虹","亲亲","心","心碎","玫瑰花","玫瑰凋零","生日蛋糕","棒棒糖","饭","勾引","OK","耶","握手","强","弱","咖啡","酒","西瓜","刀","冒泡","演唱会","疑问","NoNo","被欺负","耍赖","嗯嗯","茫然","泪流","发飙","惊叹","寂寞","灰过","花痴","喝水","中暑","风筝","愤怒","得意","鄙视"],face2:["","发抖","可怜","刷牙","吐舌头","发飙","使坏","喂喂","兜风","抓痒","宠物","做饭","烦躁","愤怒","狂怒","看好你的","潜水","唱歌","亲亲","犯错","疑问","你好","冰冻","我不信","郁闷","路过","害羞","冲啊","跳舞","匍匐前进","我不","No","挖鼻孔","大哭","发光","发傻","拍pp","跑步","楚楚可怜","惊讶","跳绳","美女啊","byebye","偷瞄一眼","做飞机","有怪兽","装可爱","喝茶","偷笑","打盹","放风筝","抓痒","钓鱼","愤愤不平","吃面","洗澡","切","兴奋","犯困","翻桌子","兜风","尴尬","野蛮女友","垂钓","等待","得意","撒娇","开飞船","吵闹","愤怒","呕吐"],face3:["","疑问","很晚了","微笑","吐舌头","财神","偷笑","跳舞","大哭","小样","残花","邪恶","再见","鬼脸","炸弹","安慰","闭嘴","成交","惊声尖叫","再见","傻笑","心碎","惊愕","天使","亲亲","晕","爱慕","欠扁","小二","飞吻","学习雷锋","生气","呆若木鸡","算账","花痴","T服了U","隐形人","CS","困了","委屈","无奈","害羞","财迷","无聊","等待","胜利","抱抱","嘘","怀疑","握手","露齿笑","爱心","大怒","加油","思考","尴尬","享受","恭喜发财","流汗","吐","摇头","支付宝","不会吧","色情狂","痛苦","惊讶","钱","悲泣","生病","好主意","招财猫","单挑","背","玫瑰","大笑","鼓掌","鄙视你","凄凉","感冒","老大","呼叫","查找","没钱了","强"],face6:["","悲剧收场","打瞌睡","不行不行","睡觉去了","谁叫我？","干嘛","晕头转向","拍砖头","晕倒","踹死你","宰了你","流汗","为了新中国","练气功","春心荡漾","发癫了","泪流满面","得意忘形","少林功夫","红星闪闪","白日梦","发奋图强","优哉游哉","撞墙","趾高气扬","别烦我","生日快乐","抖胸","挠痒痒","少林功夫","醒醒吧","听音乐","奋发向上","失望","不要嘛","拼了","挥泪送别","一起得意","真的不行","仙飘飘","哎呀","爱死你了"]};this.defcss="float:left;cursor:pointer;cursor:hand;width:48px;color:#6a6864;background:url(http://static.51img1.com/v3/home/images/mb.gif) no-repeat 0 0;text-align:center;margin-top:3px;";this.selcss="float:left;cursor:pointer;cursor:hand;width:48px;position:relative;top:1px;*top:0px;_top:0px;line-height:23px;color:#000;text-decoration:underline;width:48px;background:url(http://static.51img1.com/v3/home/images/ma.gif) no-repeat 0 0;text-align:center;";this.butt=null;this.otxt=null;this.ontab=null;this.onclass="face8";this.onimg="";this.isIE=jQuery.browser.msie;this.isFF=jQuery.browser.mozilla;this.isGG=/Chrome/.test(navigator.userAgent);this.isIE6=jQuery.browser.version==6;this.isIE7=jQuery.browser.version==7;this.isIE8=jQuery.browser.version==8;this.init=function(){if(this.isInit){return;}document.body.insertAdjacentHTML("beforeEnd",'			<div id="public_51face_box" style="display:none;position:absolute;z-index:1198;width:410px;height:182px;border:1px #004b97 solid;background:#fff;">				<ul id="public_51face_tab" style="height:23px;margin-top:1px;line-height:20px;overflow:hidden;list-style-type:none;padding-left:2px;">					<li style="'+this.selcss+'" id="public_51face_tab_def">默认</li>					<li style="'+this.defcss+'">悠嘻猴</li>					<li style="'+this.defcss+'">旺旺</li>					<li style="'+this.defcss+'">兔斯基</li>					<li style="float:right;margin-top:4px;_margin-top:3px;cursor:pointer;cursor:hand;"><img src="http://static.51img1.com/v3/home/images/close3.gif" width="43" height="16" alt="关闭" title="关闭" onclick="'+this.name+'.hide();" /></li>				</ul>				<div style="clear:both; display:block; height:0;font-size:0/0; overflow:hidden; margin:0 auto; padding:0; border:0; background-color:#fff;"></div>				<div style="width:100%; height:160px; margin-top:-3px; *margin-top:-4px; _margin-top:-4px; border-top:1px #aeaeae solid;text-align:center;">					<div id="public_51face_img_div" style="width:407px; height:158px; cursor:pointer;cursor:hand;margin:1px auto 0 auto;" onmousemove="'+this.name+'.moveFaceEvent(event);" onmouseout="'+this.name+'.moveFaceOutEvent(event)">						<img id="public_51face_img" src="http://static.51img1.com/v3/face/small/face8.gif" width="407" height="158" border="0" />					</div>				</div>				<div id="public_51face_select_box" style="display:none;position:absolute;border:1px #f00 solid;width:24px;height:23px;background:transparent;"><div id="public_51face_title_box" style="filter:alpha(opacity=0);-moz-opacity:0;opacity:0;background:red;height:100%;width:100%;"></div></div>				<table id="public_51face_show_left_box" style="display:none;left:2px;position:absolute;top:23px;width:64px!important;height:64px;border:1px #777 solid;background:#fff;" width="64" height="64" border="0" cellspacing="0" cellpadding="0"><tr><td align="center" valign="middle"><img id="public_51face_show_left_img" src="http://static.51img1.com/v3/home/images/tms.gif" /></td></tr></table>				<table id="public_51face_show_right_box" style="display:none;right:2px;position:absolute;top:23px;width:64px!important;height:64px;border:1px #777 solid;background:#fff;" width="64" height="64" border="0" cellspacing="0" cellpadding="0"><tr><td align="center" valign="middle"><img id="public_51face_show_right_img" src="http://static.51img1.com/v3/home/images/tms.gif" /></td></tr></table>			</div>');jQuery("li","#public_51face_tab").click(function(h){h=h||event;var f=h.srcElement;var g=jQuery(f).text().trim();var d="";var c="face8";switch(g){case"默认":d="face8.gif";c="face8";break;case"悠嘻猴":d="face2.gif";c="face2";break;case"旺旺":d="face3.gif";c="face3";break;case"兔斯基":d="face6.gif";c="face6";break;default:d="";}if(d==""){return;}b.gID("public_51face_img").src="http://static.51img1.com/v3/face/small/"+d;if(b.ontab==null){b.ontab=b.gID("public_51face_tab_def");}b.ontab.style.cssText=b.defcss;b.ontab=f;b.onclass=c;f.style.cssText=b.selcss;});jQuery("#public_51face_img_div,#public_51face_select_box").click(function(d){d=d||event;var c=b.onimg;if(c==""){return;}b.faceInstallIco(c.replace("http://static.51img1.com/v3/face/",""));});this.isInit=true;return;};this.show=function(f,d,g){if(!this.isInit){this.init();}if(jQuery("#public_51face_box").is(":visible")){return this.hide();}if(typeof f!="object"){return window.alert("参数错误.");}if(d==""){return window.alert("参数错误 .");}else{this.otxt=this.gID(d);if(!this.otxt){return window.alert(d+"DOM不存在.");}if(!jQuery(this.otxt).attr("caretPos")){jQuery(this.otxt).attr("caretPos",{text:""});}}this.butt=f;if(jQuery(this.otxt).attr("isfaceevent")!="1"){jQuery(this.otxt).attr("isfaceevent",1);}jQuery(document).bind("mousedown",this.faceDocumentClick);var e=jQuery(this.butt).offset();var c=this.butt.offsetHeight;g=g||0;jQuery("#public_51face_box").css({top:(e.top+c+g),left:e.left+1}).show();};this.hide=function(){jQuery(document).unbind("mousedown",this.faceDocumentClick);this.butt=null;this.otxt.removeAttribute("caretPos");this.otxt=null;jQuery("#public_51face_box").hide();this.faceEventclear();};this.faceDocumentClick=function(d){d=d||event;var c=d.srcElement;if(b.gID("public_51face_box").contains(c)||c==b.gID("public_51face_select_box")||c==b.butt){return;}b.hide();};this.faceInstallIco=function(g){var m="[img]"+g+"[/img]";var d=this.otxt;if(!d){return;}if(this.isIE){if(d.createTextRange&&d.caretPos){var h=d.caretPos;try{h.text=h.text.charAt(h.text.length-1)=="   "?m+"   ":m;}catch(k){d.value=d.value+m;}}else{d.value=d.value+m;}}else{if(d.setSelectionRange){var l=d.selectionStart;var c=d.selectionEnd;var j=d.value.substring(0,l);var f=d.value.substring(c);d.value=j+m+f;}else{alert("您当前的浏览器不支持此操作,不能插入表情图标.");}}d.focus();this.hide();};this.faceEventclear=function(){this.onimg="";jQuery("#public_51face_show_left_box,#public_51face_show_right_box,#public_51face_select_box").hide();};this.moveFaceOutEvent=function(d){d=d||event;var c=d.toElement;if(c==this.gID("public_51face_select_box")||c==this.gID("public_51face_title_box")){return;}this.faceEventclear();};this.moveFaceEvent=function(g){g=g||event;var h=this.isFF?g.offsetY-27:g.offsetY;var i=g.offsetX;var c=Math.floor((i+Math.floor(i/28))/28)+1;var l=Math.floor((h+Math.floor(h/27))/27)+1;var k=(l-1)*15+c;var m=this.onclass;var j=this.titles[m][k];if(k>0&&c<16){jQuery("#public_51face_select_box").css({top:(l*25-2+l),left:((c-1)*27+(!this.isIE?3:2))}).show();jQuery("#public_51face_title_box").attr("title",j);if(m=="face2"){var d=70;}else{if(m=="face3"){var d=83;}else{if(m=="face6"){var d=42;}else{var d=90;}}}if(k>d){this.faceEventclear();return;}k=m=="face8"?(k+201):k;var f="http://static.51img1.com/v3/face/"+m+"/"+(k-1)+".gif";this.onimg=f;if(c<4){jQuery("#public_51face_show_left_box").hide();jQuery("#public_51face_show_right_img").attr("src",f);jQuery("#public_51face_show_right_box").show();}else{jQuery("#public_51face_show_right_box").hide();jQuery("#public_51face_show_left_img").attr("src",f);jQuery("#public_51face_show_left_box").show();}}else{this.faceEventclear();}};this.faceSetCaret=function(c){if(c.createTextRange){c.setAttribute("caretPos",document.selection.createRange().duplicate());}};this.gID=function(c){return typeof(c)!="string"?c:document.getElementById(c);};}var face51New=new faceTo51All("face51New");/* 2011-12-13 10:08:21 */ 
