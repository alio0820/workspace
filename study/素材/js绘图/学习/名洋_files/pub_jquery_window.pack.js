(function($){jQuery.extend({block:{isFrame:(isIE&&jQuery.browser.version<7),isShow:0,isInit:0,init:function(){var fra='<iframe id="UI__BLOCK_IFRAME" name="UI_MOVE_IFRAME" src="about:blank" frameborder="0" border="0" scrolling="no" onselectstart="return false;"></iframe>';var div='<div id="UI__BLOCK_DIV" onselectstart="return false;"></div>';this.isFrame&&document.body.insertAdjacentHTML("beforeEnd",fra+div)||document.body.insertAdjacentHTML("beforeEnd",div);fra=div=null;},setup:function(op){!this.isInit&&this.init();op=op||{};var color=op.color||"#6CF";var psize=op.size||jQuery.pageSize||jQuery.PageSize();var alpha=jQuery.Int(op.alpha);alpha=!alpha?0:alpha;var zindex=jQuery.Int(op.zindex)||900000;var wW=op.width||Math.max(psize.wW,psize.pW);var pH=Math.max(psize.wH,psize.pH);isGG&&(wW=wW-17);isIE&&(wW=wW-4);jQuery("#UI__BLOCK_DIV").css({zIndex:zindex,background:color,width:wW,height:pH,opacity:alpha});this.isFrame&&jQuery("#UI__BLOCK_IFRAME").css({width:wW,height:pH,zIndex:zindex-1});},open:function(options){if(this.isShow){return;}this.setup(options);this.isFrame&&jQuery("#UI__BLOCK_IFRAME,#UI__BLOCK_DIV").show()||jQuery("#UI__BLOCK_DIV").show();this.isShow=-1;},close:function(){if(this.isShow){this.isFrame&&jQuery("#UI__BLOCK_IFRAME,#UI__BLOCK_DIV").hide()||jQuery("#UI__BLOCK_DIV").hide();this.isShow=0;}},rexy:function(){var psize=jQuery.pageSize;var wW=Math.max(psize.wW,psize.pW);var pH=Math.max(psize.wH,psize.pH);jQuery("#UI__BLOCK_DIV").css({width:wW,height:pH});this.isFrame&&jQuery("#UI__BLOCK_IFRAME").css({width:wW,height:pH});psize=wW=pH=null;}},win:{isShow:0,isInit:0,itemHs:{},closeFun:null,init:function(){document.body.insertAdjacentHTML("beforeEnd",'<div id="WIN_BOXS"><div id="WIN_TOPS" drag="WIN_BOXS" onselectstart="return false;"><span id="WIN_TITL" drag="WIN_BOXS"></span><a href="javascript:jQuery.win.close();void(0);" id="WIN_CLOS" hidefocus="true"></a></div><div id="WIN_BODY"></div></div>');this.isInit=-1;},setup:function(op){op=op||{};!this.isInit&&this.init();var pw=jQuery.pageSize||jQuery.PageSize();var sc=jQuery.Scroll();var wWidth=op.width||350;var wHeight=op.height||185;var wW=op.winw||pw.wW;var wH=op.winh||pw.wH;var st=op.scrollt||sc.top;var sl=op.scrolll||sc.left;var close=op.close||"block";var zindex=op.zindex||1000000;var title=op.title||"系统消息";this.closeFun=op.close_fun||null;if(!(op.item in this.itemHs)){jQuery.Id("WIN_BODY").appendChild(jQuery.Id(op.item));this.itemHs[op.item]=-1;}var items=jQuery.Id("WIN_BODY").childNodes;for(var i=0;i<items.length;i++){items[i].style.display="none";}jQuery.Id("WIN_CLOS").style.display=close;jQuery.Id("WIN_TITL").innerHTML=title;with(jQuery.Id("WIN_BOXS").style){zIndex=zindex;width=wWidth+"px";height=wHeight+"px";top=((wH-wHeight)/2)+st+"px";left=((wW-wWidth)/2)+sl+"px";}jQuery.Id("WIN_BODY").style.width=wWidth-10+"px";jQuery.Id("WIN_BODY").style.height=wHeight-37+"px";jQuery.Id(op.item).style.display="block";},open:function(op){this.setup(op);this.isShow=-1;jQuery.Id("WIN_BOXS").style.display="block";},close:function(){if(!this.isShow){return;}this.isShow=0;jQuery.Id("WIN_BOXS").style.display="none";jQuery.block.isShow&&jQuery.block.close();this.closeFun&&this.closeFun();items=null;},rexy:function(){var sc=jQuery.Scroll();jQuery.Id("WIN_BOXS").style.top=((jQuery.pageSize.wH-jQuery.Id("WIN_BOXS").offsetHeight)/2)+sc.top+"px";jQuery.Id("WIN_BOXS").style.left=((jQuery.pageSize.wW-jQuery.Id("WIN_BOXS").offsetWidth)/2)+sc.left+"px";sc=null;}}});$.fn.tips=function(param){param=$.extend({attr:"tips",delay:0,mouse:1},param);return this.each(function(){var $t=$(this);if(!$t.attr(param.attr)){return;}var $t_title=$("<div>"+$t.attr(param.attr)+"</div>");var initPos=[0,0];$t.hover(function(e){if(param.mouse==1){initPos[0]=e.pageX;initPos[1]=e.pageY;}$t_title.appendTo($("body")).css({left:(e.pageX+2)+"px",top:(e.pageY+20)+"px",position:"absolute",border:"1px solid #333",background:"#fff",color:"#000",padding:"4px 6px",display:"block",zIndex:1657821}).show();},function(e){if(param.mouse==1){initPos[0]=0;initPos[1]=0;}$t_title.remove();});if(param.mouse==1){$t.mousemove(function(e){$t_title.css({left:(e.pageX+2)+"px",top:(e.pageY+20)+"px"});});}});};$.extend({homepop:function(param){this.hide=function(){param.closed=1;param.wrapbox&&param.wrapbox.hide();};this.show=function(){param.closed=0;get__PageSize();sys_horn_unit();param.wrapbox&&param.wrapbox.show();};param=$.extend({message:["tips"],width:300,height:200,delay:0,boxcls:"pop_laba",title:"主页公告",scrollflag:0,scrolltime:0,current_index:0,wrapbox:null,closed:1},param);param.length=param.message.length;if(param.length==0){return this;}var WH=jQuery.pageSize||jQuery.PageSize();var left=WH.wW-param.width;var top=WH.wH;var minfo=getmessage(0);var content=minfo.content;param.width=minfo.width;param.height=minfo.height;width=(param.width-2)+"px";height=param.height+"px";$('<div id="sys_horn_area" style="position:absolute;width:'+width+";height:"+height+";left:"+left+"px;top:"+top+'px;display:none;" class="'+param.boxcls+'">					<div class="head"><table cellpadding="0" cellspacing="0" width="100%"><tr><td height="28" class="d1">&nbsp;</td><td class="d2">&nbsp;</td><td class="d3"><a href="javascript:void(0);" class="close">&nbsp;</a></td></tr></table></div>					<div class="main">				    <div class="con">'+content+'</div>				    <div class="bottom">'+getbottom()+"</div>					</div>				</div>").appendTo($("body"));param.wrapbox=$("#sys_horn_area");param.wrapbox.find(".close").bind("click",closemessage);param.wrapbox.find(".leftarrow").bind("click",prevmessage);param.wrapbox.find(".rightarrow").bind("click",nextmessage);$(window).bind("resize",sys_horn_unit);$(window).bind("scroll",function(){if(!param.scrollflag){param.scrollflag=window.setTimeout(sys_horn_unit,50);}});function getbottom(){var leftarrow='<span class="leftarrow" style="cursor:pointer;" href="javascript:void(0);"><img src="http://static.51img1.com/v3/home/images/laba_l'+(param.current_index==0?"0":"")+'.gif" /></span>';var rightarrow='<span class="rightarrow" style="cursor:pointer;" href="javascript:void(0);"><img src="http://static.51img1.com/v3/home/images/laba_r'+((param.current_index+1)==param.length?"0":"")+'.gif" /></span>';return leftarrow+'<span>(<span class="current">'+(param.current_index+1)+"</span>/"+param.length+")</span>"+rightarrow;}function getmessage(mindex){var content=typeof param.message[mindex]!=="string"?param.message[mindex]["memo"]:param.message[mindex];var width=typeof param.message[mindex]!=="string"?param.message[mindex]["width"]:param.width;var height=typeof param.message[mindex]!=="string"?param.message[mindex]["height"]:param.height;var id=param.message[mindex]["id"];return{content:content,width:width,height:height,id:id};}function closemessage(){var minfo=getmessage(param.current_index);param.closed=1;param.wrapbox.fadeOut();postreaded(minfo.id,"closewin");}function prevmessage(){if(param.current_index==0){return;}tabmessage(param.current_index-1);}function nextmessage(){if(param.current_index==param.length-1){return;}var minfo=getmessage(param.current_index);var minfo2=getmessage(param.current_index+1);if(param.current_index==0){postreaded(minfo.id+","+minfo2.id,"nextpage");}else{postreaded(minfo2.id,"nextpage");}tabmessage(param.current_index+1);}function postreaded(ids,act){$.ajax({type:"post",url:"/?c=up&a=readid",data:"ids="+ids+"&"+act+"=1",success:function(data){}});}function tabmessage(mindex){var minfo=getmessage(mindex);param.current_index=mindex;param.width=minfo.width;param.height=minfo.height;if(param.current_index==0){param.wrapbox.find(".leftarrow img").attr("src","http://static.51img1.com/v3/home/images/laba_l0.gif");}else{param.wrapbox.find(".leftarrow img").attr("src","http://static.51img1.com/v3/home/images/laba_l.gif");}if(param.current_index==param.length-1){param.wrapbox.find(".rightarrow img").attr("src","http://static.51img1.com/v3/home/images/laba_r0.gif");}else{param.wrapbox.find(".rightarrow img").attr("src","http://static.51img1.com/v3/home/images/laba_r.gif");}param.wrapbox.find(".current").html((param.current_index+1));param.wrapbox.find(".con").html(minfo.content);sys_horn_unit();}function sys_horn_unit(){if(param.scrollflag){window.clearTimeout(param.scrollflag);param.scrollflag=0;}param.length=param.message.length;if(param.length==0){return this;}if(param.closed==1){return this;}var h=(document.documentElement.scrollTop||document.body.scrollTop);var WH=jQuery.pageSize||jQuery.PageSize();if(parseInt(param.wrapbox.css("top"),10)+param.height<h){param.wrapbox.css("top",(h-200)+"px");}else{if(parseInt(param.wrapbox.css("top"),10)+param.height>(h+WH.wH+param.height)){param.wrapbox.css("top",(h+WH.wH)+"px");}}var width=(param.width-2)+"px";var height=param.height+"px";param.wrapbox.find(".con").css("height",(param.height-62)+"px");var func=[function(){param.wrapbox.animate({top:(h+WH.wH-param.height-1)+"px",left:(WH.wW-param.width-1)+"px",width:width,height:height},"slow");}];var tim=new Date();scrolltime2=tim.getTime();if((scrolltime2-param.scrolltime)<200){param.wrapbox.stop();scrollflag=window.setTimeout(arguments.callee,13);return;}else{param.scrolltime=scrolltime2;}$(document).queue("sys_horn",func);$(document).dequeue("sys_horn");}return this;}});var obj__on__drag=null;function ____docMousedown_f(e){e=e||window.event;e.stopPropagation();var eo=e.srcElement;var tx=jQuery(eo).attr("drag")||"";if(e.which!=1||tx==""){return;}obj__on__drag=jQuery.Id(tx);eo=tx=null;var xy=jQuery(obj__on__drag).offset();var so=jQuery.Scroll();obj__on__drag.xL=e.clientX-xy.left;obj__on__drag.yT=e.clientY-xy.top;obj__on__drag._w=obj__on__drag.offsetWidth;obj__on__drag._h=obj__on__drag.offsetHeight;obj__on__drag._t=so.top;obj__on__drag._l=so.left;obj__on__drag.setCapture&&obj__on__drag.setCapture();jQuery(document).mousemove(____docMousemove_f).mouseup(____docMouseup_f);xy=so=null;}function ____docMousemove_f(e){e=e||window.event;e.stopPropagation();if(jQuery.Null(obj__on__drag)){return;}var fox=isGG?18:0;var toX=Math.max(Math.min(e.clientX-obj__on__drag.xL,obj__on__drag._l+jQuery.pageSize.wW-obj__on__drag._w-fox),obj__on__drag._l);var toY=Math.max(Math.min(e.clientY-obj__on__drag.yT,obj__on__drag._t+jQuery.pageSize.wH-obj__on__drag._h),obj__on__drag._t);with(obj__on__drag.style){top=toY+"px";left=toX+"px";}}function ____docMouseup_f(e){e=e||window.event;e.stopPropagation();if(jQuery.Null(obj__on__drag)){return;}obj__on__drag.releaseCapture&&obj__on__drag.releaseCapture();jQuery(document).unbind("mousemove",____docMousemove_f).unbind("mouseup",____docMouseup_f);obj__on__drag=null;}jQuery(window).resize(function(){try{if(jQuery.win.isShow){jQuery.win.rexy();}if(jQuery.block.isShow){jQuery.block.rexy();}}catch(e){}});jQuery(document).mousedown(____docMousedown_f);})(jQuery);/* 2010/04/29 11:34:54 */ 
