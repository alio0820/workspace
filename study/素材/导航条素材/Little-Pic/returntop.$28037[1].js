Fx.Scroll=new Class({Extends:Fx,options:{offset:{x:0,y:0},wheelStops:true},initialize:function(b,a){this.element=this.subject=document.id(b);this.parent(a);if(typeof(this.element)!="element"){this.element=document.id(this.element.getDocument().body)}if(this.options.wheelStops){var c=this.element,d=this.cancel.pass(false,this);this.addEvent("start",function(){c.addEvent("mousewheel",d)},true);this.addEvent("complete",function(){c.removeEvent("mousewheel",d)},true)}},set:function(){var a=Array.flatten(arguments);if(Browser.firefox){a=[Math.round(a[0]),Math.round(a[1])]}this.element.scrollTo(a[0],a[1])},compute:function(c,b,a){return[0,1].map(function(d){return Fx.compute(c[d],b[d],a)})},start:function(b,c){if(!this.check(b,c)){return this}var a=this.element.getScroll();return this.parent([a.x,a.y],[b,c])},calculateScroll:function(f,e){var c=this.element,a=c.getScrollSize(),g=c.getScroll(),i=c.getSize(),b=this.options.offset,h={x:f,y:e};for(var d in h){if(!h[d]&&h[d]!==0){h[d]=g[d]}if(typeof(h[d])!="number"){h[d]=a[d]-i[d]}h[d]+=b[d]}return[h.x,h.y]},toTop:function(){return this.start.apply(this,this.calculateScroll(false,0))}});var returnTop={timer:{},duration:100,toTop:function(e){e=$(e);if(!e){return}var d=new Fx.Tween(e,{duration:250});var c=this;e.addEvent("click",function(){if(Browser.Engine.trident4){window.scrollTo(0,0)}else{new Fx.Scroll(document.body,{onStart:function(){e.erase("show");d.start("opacity",0);clearInterval(c.timer.toTop)},onComplete:function(){c.timer.toTop=setInterval(f,100)}}).toTop()}});c.timer.toTop=setInterval(f,100);var g,b,a=e.getHeight();function f(){g=window.getScrollTop();b=window.getHeight();if(g>0){if(Browser.Engine.trident4){var h=g+b-a;e.setStyle("top",h+"px")}if(e.get("show")){return}e.set("show",true);d.start("opacity",1)}else{if(!e.get("show")){return}e.erase("show");d.start("opacity",0)}}}};